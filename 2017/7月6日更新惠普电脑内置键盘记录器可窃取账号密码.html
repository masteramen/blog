<!DOCTYPE html>
<html lang="zh_CN"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.5.0 -->
<title>【7月6日更新】惠普电脑内置键盘记录器？可窃取账号密码等敏感用户信息 | Java面试</title>
<meta name="generator" content="Jekyll v3.8.4" />
<meta property="og:title" content="【7月6日更新】惠普电脑内置键盘记录器？可窃取账号密码等敏感用户信息" />
<meta property="og:locale" content="zh_CN" />
<meta name="description" content="你在使用惠普电脑吗？如果答案是肯定的，那么请小心了，你的音频驱动程序可能会存储你的击键记录，甚至泄露你的重要信息。 7.6更新 6月，某部委下属网络安全和信息化领导小组办公室已经发布公告通报了惠普电脑存在隐藏键盘记录器问题。据说国内不少公务员也在用着惠普的PC设备，信息隐患实在细思恐极。 而事实上，5月中旬，瑞士安全公司Modzero的安全研究员 Thorsten Schroeder 就已经发现，许多惠普笔记本电脑和平板电脑中的Conexant音频驱动程序变身Keylogger，记录用户的击键内容。Keylogger可以监测用户的每一次击键信息。该软件不仅仅捕获了特定按键的按键记录，而且还记录了每个按键的点击信息，并将它们存储在一个可读的文件中（ C:UsersPublicMicTray.log）。恶意软件或木马可以利用这一点，绕过系统对可疑行为的安全检测，获取记录文件，窃取用户的账户信息、信用卡卡号、聊天记录、密码等个人信息。 Conexant是一家集成电路制造商，既生产音频芯片也开发相关驱动程序。Conexant High-Definition (HD) Audio Driver音频驱动程序可帮助软件与硬件进行通信。惠普公司根据不同的计算机型号，在Conexant音频驱动程序中写入一些控制特定按键（如媒体按键）的代码。研究人员发现，与Conexant音频驱动程序安装包一起安装的MicTray64.exe应用程序已在Windows系统中注册为计划任务，能够监控击键内容以确定用户是否按下了音频相关的按钮（例如静音/取消静音）。用户的击键记录保存在名为“Users/Public”的文件夹中，可以传送给OutputDebugString调试端口，这个端口允许通过MapViewOfFile函数访问该文件夹中的数据。 音频驱动程序变成间谍软件 Schroeder在一篇博客中表示，该软件的目的是识别用户是否已经按下或松开特殊键。但是开发人员加入了诊断和调试功能，用于确保所有按键都可以通过调试界面广播出去，也可以写入硬盘上公共目录中的日志文件。这种调试将音频驱动程序转换成了内置的Keylogger。 研究显示，2015年12月发布的MicTray64.exe的早期版本并不会把击键记录存储到文件夹中。2016年10月，惠普将MicTray64.exe更新到1.0.0.46版本，增添了诊断功能，记录用户击键内容并存储到本地文件夹。目前，共有30种型号的惠普电脑装有1.0.0.46版本的MicTray64.exe。而根据文件的元信息，至少在2015年圣诞节时期，惠普电脑安装的该驱动程序就已经存在击键记录行为。 MicTray64.exe 1.0.0.46版本进行击键记录的具体过程如下： int64 keylogger_enable(bool activate) { [...] if ( !keylogger_active ) { [...] // 13=WH_KEYBOARD_LL: Installs a hook procedure that // monitors low-level keyboard input events. For // more information, see the LowLevelKeyboardProc // hook procedure. hKeyloggerHook = SetWindowsHookExW( 13, (HOOKPROC)handle_scancode, hSelf, 0); if ( hKeyloggerHook ) { keylogger_active = 1; return 0; } [...] } 记录功能激活之后，用户每按一次键盘，就会触发以下伪代码执行： LRESULT handle_scancode( int _in_nCode, WPARAM _in_wParam, tagKBDLLHOOKSTRUCT *_in_lParam_keystroke) { tagKBDLLHOOKSTRUCT *key_stroke; WPARAM wParam; int nCode; int64 target; DWORD is_keyfoo; int is_keydown; char tmp; int64 key_flags; int64 key_vk; key_stroke = _in_lParam_keystroke; wParam = _in_wParam; nCode = _in_nCode; if ( _in_nCode &gt;= 0 ) { target = (cfg_HotKeyMicScancode &gt;&gt; 8 * (cfg_HotKeyMicScancode_len - cfg_HotKeyMicScancode_len2)); LODWORD(key_vk) = _in_lParam_keystroke-&gt;vkCode; LODWORD(key_flags) = _in_lParam_keystroke-&gt;flags; is_keyfoo = _in_lParam_keystroke-&gt;flags &amp; 1; is_keydown = ~(key_flags &gt;&gt; 7) &amp; 1; [*] send_to_dbglog( 0x1D, L&quot;Mic target 0x%x scancode 0x%x flags 0x%x extra 0x%x vk 0x%xn&quot;, target, _in_lParam_keystroke-&gt;scanCode, key_flags, _in_lParam_keystroke-&gt;dwExtraInfo, key_vk); conexant_handle_fn_keys( cfg_MicMuteScancodeSettings, is_keydown, key_stroke-&gt;scanCode, target, &amp;cfg_HotKeyMicScancode_len, &amp;cfg_HotKeyMicScancode_len2, 1); if ( cfg_MicMuteScancodeSettings &amp; 4 ) conexant_handle_fn_keys( cfg_MicMuteScancodeSettings, is_keydown, key_stroke-&gt;scanCode, (cfg_HotKeyMicScancode2 &gt;&gt; 8 * (cfg_HotKeyMicScancode2_len - cfg_HotKeyMicScancode2_len2)), &amp;cfg_HotKeyMicScancode2_len, &amp;cfg_HotKeyMicScancode2_len2, 1); tmp = cfg_SpkMuteScancodeSettings; if ( cfg_SpkMuteScancodeSettings &amp; 8 &amp;&amp; is_keyfoo || !(cfg_SpkMuteScancodeSettings &amp; 8) ) { conexant_handle_fn_keys( cfg_SpkMuteScancodeSettings, is_keydown, key_stroke-&gt;scanCode, (cfg_HotKeySpkScancode &gt;&gt; 8 * (cfg_HotKeySpkScancode_len - cfg_HotKeySpkScancode_len2)), &amp;dword_1402709C8, &amp;dword_1402709CC, 0); tmp = cfg_SpkMuteScancodeSettings; } if ( tmp &amp; 4 &amp;&amp; (tmp &amp; 8 &amp;&amp; is_keyfoo || !(tmp &amp; 8)) ) conexant_handle_fn_keys( tmp, is_keydown, key_stroke-&gt;scanCode, (cfg_HotKeySpkScancode2 &gt;&gt; 8 * (cfg_HotKeySpkScancode2_len - cfg_HotKeySpkScancode2_len2)), &amp;cfg_HotKeySpkScancode2_len, &amp;cfg_HotKeySpkScancode2_len2, 0); } return CallNextHookEx(hhk, nCode, wParam, key_stroke); } 其中，[*]那部分代码触发的功能可以将击键记录写入文件，或通过运行store_keystroke()代码，将击键记录经由Microsofts Debug Monitor 接口广播出去： void store_keystroke(LPCVOID lpBuffer) { WORD *scancode_logline; int64 str_len; DWORD NumberOfBytesWritten; int str_newline; scancode_logline = lpBuffer; if ( g_write_to_logfile ) { SetFilePointer(g_hFile, 0, 0, 2); str_len = -1; while ( scancode_logline[str_len++ + 1] != 0 ) ; WriteFile( g_hFile, scancode_logline, 2 * str_len, &amp;NumberOfBytesWritten, 0); str_newline = &#39;nr&#39;; WriteFile(g_hFile, &amp;str_newline, 4, &amp;NumberOfBytesWritten, 0); } else { OutputDebugStringW(lpBuffer); } } 而目前没有证据表明惠普有意为Conexant音频驱动程序加入击键记录功能。 这很可能是开发人员疏忽导致的问题，使得该程序对用户造成潜在威胁。 存在风险的电脑型号及系统 该漏洞被记录为“CVE-2017-8360”漏洞，已经影响了28款惠普笔记本电脑和平板电脑，包括EliteBook 800系列，EliteBook Folio G1，Elite X2, ProBook 600 和400系列, and ZBook等型号。Modzero的安全专家推断其他厂商出产的电脑如果装有Conexant硬件或驱动程序，也可能存在类似风险。 以下为存在问题的电脑型号： HP EliteBook 820 G3 Notebook PC HP EliteBook 828 G3 Notebook PC HP EliteBook 840 G3 Notebook PC HP EliteBook 848 G3 Notebook PC HP EliteBook 850 G3 Notebook PC HP ProBook 640 G2 Notebook PC HP ProBook 650 G2 Notebook PC HP ProBook 645 G2 Notebook PC HP ProBook 655 G2 Notebook PC HP ProBook 450 G3 Notebook PC HP ProBook 430 G3 Notebook PC HP ProBook 440 G3 Notebook PC HP ProBook 446 G3 Notebook PC HP ProBook 470 G3 Notebook PC HP ProBook 455 G3 Notebook PC HP EliteBook 725 G3 Notebook PC HP EliteBook 745 G3 Notebook PC HP EliteBook 755 G3 Notebook PC HP EliteBook 1030 G1 Notebook PC HP ZBook 15u G3 Mobile Workstation HP Elite x2 1012 G1 Tablet HP Elite x2 1012 G1 with Travel Keyboard HP Elite x2 1012 G1 Advanced Keyboard HP EliteBook Folio 1040 G3 Notebook PC HP ZBook 17 G3 Mobile Workstation HP ZBook 15 G3 Mobile Workstation HP ZBook Studio G3 Mobile Workstation HP EliteBook Folio G1 Notebook PC 可能会受影响的系统如下： Microsoft Windows 10 32 Microsoft Windows 10 64 Microsoft Windows 10 IOT Enterprise 32-Bit (x86) Microsoft Windows 10 IOT Enterprise 64-Bit (x86) Microsoft Windows 7 Enterprise 32 Edition Microsoft Windows 7 Enterprise 64 Edition Microsoft Windows 7 Home Basic 32 Edition Microsoft Windows 7 Home Basic 64 Edition Microsoft Windows 7 Home Premium 32 Edition Microsoft Windows 7 Home Premium 64 Edition Microsoft Windows 7 Professional 32 Edition Microsoft Windows 7 Professional 64 Edition Microsoft Windows 7 Starter 32 Edition Microsoft Windows 7 Ultimate 32 Edition Microsoft Windows 7 Ultimate 64 Edition Microsoft Windows Embedded Standard 7 32 Microsoft Windows Embedded Standard 7E 32-Bit 应对方案 惠普已经积极做出响应，发布了修复方案。用户可以前往惠普客户支持页面，查询自己的电脑型号并下载新的音频驱动程序。此外，Windows系统更新时，也会针对这一问题进行修复。 为进一步确保安全，惠普电脑用户可以检查电脑硬盘，如果发现下列文件之一，就表明击键记录已经被获取： C:WindowsSystem32MicTray64.exe C:WindowsSystem32MicTray.exe 尽管每次登录之后文件会被覆盖，但如果程序再次启动，击键信息还是会被记录下去。如果用户将驱动程序备份到云储存或外部储存设备中，历史记录也会保存。 因此，一旦发现以上可执行的文件，用户最好立即将其删除或将文件重命名，以禁止MicTray驱动器继续读取击键记录。同时，删除“用户-公共文档”中的 MicTray.log日志文件夹。" />
<meta property="og:description" content="你在使用惠普电脑吗？如果答案是肯定的，那么请小心了，你的音频驱动程序可能会存储你的击键记录，甚至泄露你的重要信息。 7.6更新 6月，某部委下属网络安全和信息化领导小组办公室已经发布公告通报了惠普电脑存在隐藏键盘记录器问题。据说国内不少公务员也在用着惠普的PC设备，信息隐患实在细思恐极。 而事实上，5月中旬，瑞士安全公司Modzero的安全研究员 Thorsten Schroeder 就已经发现，许多惠普笔记本电脑和平板电脑中的Conexant音频驱动程序变身Keylogger，记录用户的击键内容。Keylogger可以监测用户的每一次击键信息。该软件不仅仅捕获了特定按键的按键记录，而且还记录了每个按键的点击信息，并将它们存储在一个可读的文件中（ C:UsersPublicMicTray.log）。恶意软件或木马可以利用这一点，绕过系统对可疑行为的安全检测，获取记录文件，窃取用户的账户信息、信用卡卡号、聊天记录、密码等个人信息。 Conexant是一家集成电路制造商，既生产音频芯片也开发相关驱动程序。Conexant High-Definition (HD) Audio Driver音频驱动程序可帮助软件与硬件进行通信。惠普公司根据不同的计算机型号，在Conexant音频驱动程序中写入一些控制特定按键（如媒体按键）的代码。研究人员发现，与Conexant音频驱动程序安装包一起安装的MicTray64.exe应用程序已在Windows系统中注册为计划任务，能够监控击键内容以确定用户是否按下了音频相关的按钮（例如静音/取消静音）。用户的击键记录保存在名为“Users/Public”的文件夹中，可以传送给OutputDebugString调试端口，这个端口允许通过MapViewOfFile函数访问该文件夹中的数据。 音频驱动程序变成间谍软件 Schroeder在一篇博客中表示，该软件的目的是识别用户是否已经按下或松开特殊键。但是开发人员加入了诊断和调试功能，用于确保所有按键都可以通过调试界面广播出去，也可以写入硬盘上公共目录中的日志文件。这种调试将音频驱动程序转换成了内置的Keylogger。 研究显示，2015年12月发布的MicTray64.exe的早期版本并不会把击键记录存储到文件夹中。2016年10月，惠普将MicTray64.exe更新到1.0.0.46版本，增添了诊断功能，记录用户击键内容并存储到本地文件夹。目前，共有30种型号的惠普电脑装有1.0.0.46版本的MicTray64.exe。而根据文件的元信息，至少在2015年圣诞节时期，惠普电脑安装的该驱动程序就已经存在击键记录行为。 MicTray64.exe 1.0.0.46版本进行击键记录的具体过程如下： int64 keylogger_enable(bool activate) { [...] if ( !keylogger_active ) { [...] // 13=WH_KEYBOARD_LL: Installs a hook procedure that // monitors low-level keyboard input events. For // more information, see the LowLevelKeyboardProc // hook procedure. hKeyloggerHook = SetWindowsHookExW( 13, (HOOKPROC)handle_scancode, hSelf, 0); if ( hKeyloggerHook ) { keylogger_active = 1; return 0; } [...] } 记录功能激活之后，用户每按一次键盘，就会触发以下伪代码执行： LRESULT handle_scancode( int _in_nCode, WPARAM _in_wParam, tagKBDLLHOOKSTRUCT *_in_lParam_keystroke) { tagKBDLLHOOKSTRUCT *key_stroke; WPARAM wParam; int nCode; int64 target; DWORD is_keyfoo; int is_keydown; char tmp; int64 key_flags; int64 key_vk; key_stroke = _in_lParam_keystroke; wParam = _in_wParam; nCode = _in_nCode; if ( _in_nCode &gt;= 0 ) { target = (cfg_HotKeyMicScancode &gt;&gt; 8 * (cfg_HotKeyMicScancode_len - cfg_HotKeyMicScancode_len2)); LODWORD(key_vk) = _in_lParam_keystroke-&gt;vkCode; LODWORD(key_flags) = _in_lParam_keystroke-&gt;flags; is_keyfoo = _in_lParam_keystroke-&gt;flags &amp; 1; is_keydown = ~(key_flags &gt;&gt; 7) &amp; 1; [*] send_to_dbglog( 0x1D, L&quot;Mic target 0x%x scancode 0x%x flags 0x%x extra 0x%x vk 0x%xn&quot;, target, _in_lParam_keystroke-&gt;scanCode, key_flags, _in_lParam_keystroke-&gt;dwExtraInfo, key_vk); conexant_handle_fn_keys( cfg_MicMuteScancodeSettings, is_keydown, key_stroke-&gt;scanCode, target, &amp;cfg_HotKeyMicScancode_len, &amp;cfg_HotKeyMicScancode_len2, 1); if ( cfg_MicMuteScancodeSettings &amp; 4 ) conexant_handle_fn_keys( cfg_MicMuteScancodeSettings, is_keydown, key_stroke-&gt;scanCode, (cfg_HotKeyMicScancode2 &gt;&gt; 8 * (cfg_HotKeyMicScancode2_len - cfg_HotKeyMicScancode2_len2)), &amp;cfg_HotKeyMicScancode2_len, &amp;cfg_HotKeyMicScancode2_len2, 1); tmp = cfg_SpkMuteScancodeSettings; if ( cfg_SpkMuteScancodeSettings &amp; 8 &amp;&amp; is_keyfoo || !(cfg_SpkMuteScancodeSettings &amp; 8) ) { conexant_handle_fn_keys( cfg_SpkMuteScancodeSettings, is_keydown, key_stroke-&gt;scanCode, (cfg_HotKeySpkScancode &gt;&gt; 8 * (cfg_HotKeySpkScancode_len - cfg_HotKeySpkScancode_len2)), &amp;dword_1402709C8, &amp;dword_1402709CC, 0); tmp = cfg_SpkMuteScancodeSettings; } if ( tmp &amp; 4 &amp;&amp; (tmp &amp; 8 &amp;&amp; is_keyfoo || !(tmp &amp; 8)) ) conexant_handle_fn_keys( tmp, is_keydown, key_stroke-&gt;scanCode, (cfg_HotKeySpkScancode2 &gt;&gt; 8 * (cfg_HotKeySpkScancode2_len - cfg_HotKeySpkScancode2_len2)), &amp;cfg_HotKeySpkScancode2_len, &amp;cfg_HotKeySpkScancode2_len2, 0); } return CallNextHookEx(hhk, nCode, wParam, key_stroke); } 其中，[*]那部分代码触发的功能可以将击键记录写入文件，或通过运行store_keystroke()代码，将击键记录经由Microsofts Debug Monitor 接口广播出去： void store_keystroke(LPCVOID lpBuffer) { WORD *scancode_logline; int64 str_len; DWORD NumberOfBytesWritten; int str_newline; scancode_logline = lpBuffer; if ( g_write_to_logfile ) { SetFilePointer(g_hFile, 0, 0, 2); str_len = -1; while ( scancode_logline[str_len++ + 1] != 0 ) ; WriteFile( g_hFile, scancode_logline, 2 * str_len, &amp;NumberOfBytesWritten, 0); str_newline = &#39;nr&#39;; WriteFile(g_hFile, &amp;str_newline, 4, &amp;NumberOfBytesWritten, 0); } else { OutputDebugStringW(lpBuffer); } } 而目前没有证据表明惠普有意为Conexant音频驱动程序加入击键记录功能。 这很可能是开发人员疏忽导致的问题，使得该程序对用户造成潜在威胁。 存在风险的电脑型号及系统 该漏洞被记录为“CVE-2017-8360”漏洞，已经影响了28款惠普笔记本电脑和平板电脑，包括EliteBook 800系列，EliteBook Folio G1，Elite X2, ProBook 600 和400系列, and ZBook等型号。Modzero的安全专家推断其他厂商出产的电脑如果装有Conexant硬件或驱动程序，也可能存在类似风险。 以下为存在问题的电脑型号： HP EliteBook 820 G3 Notebook PC HP EliteBook 828 G3 Notebook PC HP EliteBook 840 G3 Notebook PC HP EliteBook 848 G3 Notebook PC HP EliteBook 850 G3 Notebook PC HP ProBook 640 G2 Notebook PC HP ProBook 650 G2 Notebook PC HP ProBook 645 G2 Notebook PC HP ProBook 655 G2 Notebook PC HP ProBook 450 G3 Notebook PC HP ProBook 430 G3 Notebook PC HP ProBook 440 G3 Notebook PC HP ProBook 446 G3 Notebook PC HP ProBook 470 G3 Notebook PC HP ProBook 455 G3 Notebook PC HP EliteBook 725 G3 Notebook PC HP EliteBook 745 G3 Notebook PC HP EliteBook 755 G3 Notebook PC HP EliteBook 1030 G1 Notebook PC HP ZBook 15u G3 Mobile Workstation HP Elite x2 1012 G1 Tablet HP Elite x2 1012 G1 with Travel Keyboard HP Elite x2 1012 G1 Advanced Keyboard HP EliteBook Folio 1040 G3 Notebook PC HP ZBook 17 G3 Mobile Workstation HP ZBook 15 G3 Mobile Workstation HP ZBook Studio G3 Mobile Workstation HP EliteBook Folio G1 Notebook PC 可能会受影响的系统如下： Microsoft Windows 10 32 Microsoft Windows 10 64 Microsoft Windows 10 IOT Enterprise 32-Bit (x86) Microsoft Windows 10 IOT Enterprise 64-Bit (x86) Microsoft Windows 7 Enterprise 32 Edition Microsoft Windows 7 Enterprise 64 Edition Microsoft Windows 7 Home Basic 32 Edition Microsoft Windows 7 Home Basic 64 Edition Microsoft Windows 7 Home Premium 32 Edition Microsoft Windows 7 Home Premium 64 Edition Microsoft Windows 7 Professional 32 Edition Microsoft Windows 7 Professional 64 Edition Microsoft Windows 7 Starter 32 Edition Microsoft Windows 7 Ultimate 32 Edition Microsoft Windows 7 Ultimate 64 Edition Microsoft Windows Embedded Standard 7 32 Microsoft Windows Embedded Standard 7E 32-Bit 应对方案 惠普已经积极做出响应，发布了修复方案。用户可以前往惠普客户支持页面，查询自己的电脑型号并下载新的音频驱动程序。此外，Windows系统更新时，也会针对这一问题进行修复。 为进一步确保安全，惠普电脑用户可以检查电脑硬盘，如果发现下列文件之一，就表明击键记录已经被获取： C:WindowsSystem32MicTray64.exe C:WindowsSystem32MicTray.exe 尽管每次登录之后文件会被覆盖，但如果程序再次启动，击键信息还是会被记录下去。如果用户将驱动程序备份到云储存或外部储存设备中，历史记录也会保存。 因此，一旦发现以上可执行的文件，用户最好立即将其删除或将文件重命名，以禁止MicTray驱动器继续读取击键记录。同时，删除“用户-公共文档”中的 MicTray.log日志文件夹。" />
<link rel="canonical" href="http://www.jfox.info/2017/7%E6%9C%886%E6%97%A5%E6%9B%B4%E6%96%B0%E6%83%A0%E6%99%AE%E7%94%B5%E8%84%91%E5%86%85%E7%BD%AE%E9%94%AE%E7%9B%98%E8%AE%B0%E5%BD%95%E5%99%A8%E5%8F%AF%E7%AA%83%E5%8F%96%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81.html" />
<meta property="og:url" content="http://www.jfox.info/2017/7%E6%9C%886%E6%97%A5%E6%9B%B4%E6%96%B0%E6%83%A0%E6%99%AE%E7%94%B5%E8%84%91%E5%86%85%E7%BD%AE%E9%94%AE%E7%9B%98%E8%AE%B0%E5%BD%95%E5%99%A8%E5%8F%AF%E7%AA%83%E5%8F%96%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81.html" />
<meta property="og:site_name" content="Java面试" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2017-01-01T15:53:17+00:00" />
<script type="application/ld+json">
{"description":"你在使用惠普电脑吗？如果答案是肯定的，那么请小心了，你的音频驱动程序可能会存储你的击键记录，甚至泄露你的重要信息。 7.6更新 6月，某部委下属网络安全和信息化领导小组办公室已经发布公告通报了惠普电脑存在隐藏键盘记录器问题。据说国内不少公务员也在用着惠普的PC设备，信息隐患实在细思恐极。 而事实上，5月中旬，瑞士安全公司Modzero的安全研究员 Thorsten Schroeder 就已经发现，许多惠普笔记本电脑和平板电脑中的Conexant音频驱动程序变身Keylogger，记录用户的击键内容。Keylogger可以监测用户的每一次击键信息。该软件不仅仅捕获了特定按键的按键记录，而且还记录了每个按键的点击信息，并将它们存储在一个可读的文件中（ C:UsersPublicMicTray.log）。恶意软件或木马可以利用这一点，绕过系统对可疑行为的安全检测，获取记录文件，窃取用户的账户信息、信用卡卡号、聊天记录、密码等个人信息。 Conexant是一家集成电路制造商，既生产音频芯片也开发相关驱动程序。Conexant High-Definition (HD) Audio Driver音频驱动程序可帮助软件与硬件进行通信。惠普公司根据不同的计算机型号，在Conexant音频驱动程序中写入一些控制特定按键（如媒体按键）的代码。研究人员发现，与Conexant音频驱动程序安装包一起安装的MicTray64.exe应用程序已在Windows系统中注册为计划任务，能够监控击键内容以确定用户是否按下了音频相关的按钮（例如静音/取消静音）。用户的击键记录保存在名为“Users/Public”的文件夹中，可以传送给OutputDebugString调试端口，这个端口允许通过MapViewOfFile函数访问该文件夹中的数据。 音频驱动程序变成间谍软件 Schroeder在一篇博客中表示，该软件的目的是识别用户是否已经按下或松开特殊键。但是开发人员加入了诊断和调试功能，用于确保所有按键都可以通过调试界面广播出去，也可以写入硬盘上公共目录中的日志文件。这种调试将音频驱动程序转换成了内置的Keylogger。 研究显示，2015年12月发布的MicTray64.exe的早期版本并不会把击键记录存储到文件夹中。2016年10月，惠普将MicTray64.exe更新到1.0.0.46版本，增添了诊断功能，记录用户击键内容并存储到本地文件夹。目前，共有30种型号的惠普电脑装有1.0.0.46版本的MicTray64.exe。而根据文件的元信息，至少在2015年圣诞节时期，惠普电脑安装的该驱动程序就已经存在击键记录行为。 MicTray64.exe 1.0.0.46版本进行击键记录的具体过程如下： int64 keylogger_enable(bool activate) { [...] if ( !keylogger_active ) { [...] // 13=WH_KEYBOARD_LL: Installs a hook procedure that // monitors low-level keyboard input events. For // more information, see the LowLevelKeyboardProc // hook procedure. hKeyloggerHook = SetWindowsHookExW( 13, (HOOKPROC)handle_scancode, hSelf, 0); if ( hKeyloggerHook ) { keylogger_active = 1; return 0; } [...] } 记录功能激活之后，用户每按一次键盘，就会触发以下伪代码执行： LRESULT handle_scancode( int _in_nCode, WPARAM _in_wParam, tagKBDLLHOOKSTRUCT *_in_lParam_keystroke) { tagKBDLLHOOKSTRUCT *key_stroke; WPARAM wParam; int nCode; int64 target; DWORD is_keyfoo; int is_keydown; char tmp; int64 key_flags; int64 key_vk; key_stroke = _in_lParam_keystroke; wParam = _in_wParam; nCode = _in_nCode; if ( _in_nCode &gt;= 0 ) { target = (cfg_HotKeyMicScancode &gt;&gt; 8 * (cfg_HotKeyMicScancode_len - cfg_HotKeyMicScancode_len2)); LODWORD(key_vk) = _in_lParam_keystroke-&gt;vkCode; LODWORD(key_flags) = _in_lParam_keystroke-&gt;flags; is_keyfoo = _in_lParam_keystroke-&gt;flags &amp; 1; is_keydown = ~(key_flags &gt;&gt; 7) &amp; 1; [*] send_to_dbglog( 0x1D, L&quot;Mic target 0x%x scancode 0x%x flags 0x%x extra 0x%x vk 0x%xn&quot;, target, _in_lParam_keystroke-&gt;scanCode, key_flags, _in_lParam_keystroke-&gt;dwExtraInfo, key_vk); conexant_handle_fn_keys( cfg_MicMuteScancodeSettings, is_keydown, key_stroke-&gt;scanCode, target, &amp;cfg_HotKeyMicScancode_len, &amp;cfg_HotKeyMicScancode_len2, 1); if ( cfg_MicMuteScancodeSettings &amp; 4 ) conexant_handle_fn_keys( cfg_MicMuteScancodeSettings, is_keydown, key_stroke-&gt;scanCode, (cfg_HotKeyMicScancode2 &gt;&gt; 8 * (cfg_HotKeyMicScancode2_len - cfg_HotKeyMicScancode2_len2)), &amp;cfg_HotKeyMicScancode2_len, &amp;cfg_HotKeyMicScancode2_len2, 1); tmp = cfg_SpkMuteScancodeSettings; if ( cfg_SpkMuteScancodeSettings &amp; 8 &amp;&amp; is_keyfoo || !(cfg_SpkMuteScancodeSettings &amp; 8) ) { conexant_handle_fn_keys( cfg_SpkMuteScancodeSettings, is_keydown, key_stroke-&gt;scanCode, (cfg_HotKeySpkScancode &gt;&gt; 8 * (cfg_HotKeySpkScancode_len - cfg_HotKeySpkScancode_len2)), &amp;dword_1402709C8, &amp;dword_1402709CC, 0); tmp = cfg_SpkMuteScancodeSettings; } if ( tmp &amp; 4 &amp;&amp; (tmp &amp; 8 &amp;&amp; is_keyfoo || !(tmp &amp; 8)) ) conexant_handle_fn_keys( tmp, is_keydown, key_stroke-&gt;scanCode, (cfg_HotKeySpkScancode2 &gt;&gt; 8 * (cfg_HotKeySpkScancode2_len - cfg_HotKeySpkScancode2_len2)), &amp;cfg_HotKeySpkScancode2_len, &amp;cfg_HotKeySpkScancode2_len2, 0); } return CallNextHookEx(hhk, nCode, wParam, key_stroke); } 其中，[*]那部分代码触发的功能可以将击键记录写入文件，或通过运行store_keystroke()代码，将击键记录经由Microsofts Debug Monitor 接口广播出去： void store_keystroke(LPCVOID lpBuffer) { WORD *scancode_logline; int64 str_len; DWORD NumberOfBytesWritten; int str_newline; scancode_logline = lpBuffer; if ( g_write_to_logfile ) { SetFilePointer(g_hFile, 0, 0, 2); str_len = -1; while ( scancode_logline[str_len++ + 1] != 0 ) ; WriteFile( g_hFile, scancode_logline, 2 * str_len, &amp;NumberOfBytesWritten, 0); str_newline = &#39;nr&#39;; WriteFile(g_hFile, &amp;str_newline, 4, &amp;NumberOfBytesWritten, 0); } else { OutputDebugStringW(lpBuffer); } } 而目前没有证据表明惠普有意为Conexant音频驱动程序加入击键记录功能。 这很可能是开发人员疏忽导致的问题，使得该程序对用户造成潜在威胁。 存在风险的电脑型号及系统 该漏洞被记录为“CVE-2017-8360”漏洞，已经影响了28款惠普笔记本电脑和平板电脑，包括EliteBook 800系列，EliteBook Folio G1，Elite X2, ProBook 600 和400系列, and ZBook等型号。Modzero的安全专家推断其他厂商出产的电脑如果装有Conexant硬件或驱动程序，也可能存在类似风险。 以下为存在问题的电脑型号： HP EliteBook 820 G3 Notebook PC HP EliteBook 828 G3 Notebook PC HP EliteBook 840 G3 Notebook PC HP EliteBook 848 G3 Notebook PC HP EliteBook 850 G3 Notebook PC HP ProBook 640 G2 Notebook PC HP ProBook 650 G2 Notebook PC HP ProBook 645 G2 Notebook PC HP ProBook 655 G2 Notebook PC HP ProBook 450 G3 Notebook PC HP ProBook 430 G3 Notebook PC HP ProBook 440 G3 Notebook PC HP ProBook 446 G3 Notebook PC HP ProBook 470 G3 Notebook PC HP ProBook 455 G3 Notebook PC HP EliteBook 725 G3 Notebook PC HP EliteBook 745 G3 Notebook PC HP EliteBook 755 G3 Notebook PC HP EliteBook 1030 G1 Notebook PC HP ZBook 15u G3 Mobile Workstation HP Elite x2 1012 G1 Tablet HP Elite x2 1012 G1 with Travel Keyboard HP Elite x2 1012 G1 Advanced Keyboard HP EliteBook Folio 1040 G3 Notebook PC HP ZBook 17 G3 Mobile Workstation HP ZBook 15 G3 Mobile Workstation HP ZBook Studio G3 Mobile Workstation HP EliteBook Folio G1 Notebook PC 可能会受影响的系统如下： Microsoft Windows 10 32 Microsoft Windows 10 64 Microsoft Windows 10 IOT Enterprise 32-Bit (x86) Microsoft Windows 10 IOT Enterprise 64-Bit (x86) Microsoft Windows 7 Enterprise 32 Edition Microsoft Windows 7 Enterprise 64 Edition Microsoft Windows 7 Home Basic 32 Edition Microsoft Windows 7 Home Basic 64 Edition Microsoft Windows 7 Home Premium 32 Edition Microsoft Windows 7 Home Premium 64 Edition Microsoft Windows 7 Professional 32 Edition Microsoft Windows 7 Professional 64 Edition Microsoft Windows 7 Starter 32 Edition Microsoft Windows 7 Ultimate 32 Edition Microsoft Windows 7 Ultimate 64 Edition Microsoft Windows Embedded Standard 7 32 Microsoft Windows Embedded Standard 7E 32-Bit 应对方案 惠普已经积极做出响应，发布了修复方案。用户可以前往惠普客户支持页面，查询自己的电脑型号并下载新的音频驱动程序。此外，Windows系统更新时，也会针对这一问题进行修复。 为进一步确保安全，惠普电脑用户可以检查电脑硬盘，如果发现下列文件之一，就表明击键记录已经被获取： C:WindowsSystem32MicTray64.exe C:WindowsSystem32MicTray.exe 尽管每次登录之后文件会被覆盖，但如果程序再次启动，击键信息还是会被记录下去。如果用户将驱动程序备份到云储存或外部储存设备中，历史记录也会保存。 因此，一旦发现以上可执行的文件，用户最好立即将其删除或将文件重命名，以禁止MicTray驱动器继续读取击键记录。同时，删除“用户-公共文档”中的 MicTray.log日志文件夹。","@type":"BlogPosting","url":"http://www.jfox.info/2017/7%E6%9C%886%E6%97%A5%E6%9B%B4%E6%96%B0%E6%83%A0%E6%99%AE%E7%94%B5%E8%84%91%E5%86%85%E7%BD%AE%E9%94%AE%E7%9B%98%E8%AE%B0%E5%BD%95%E5%99%A8%E5%8F%AF%E7%AA%83%E5%8F%96%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81.html","headline":"【7月6日更新】惠普电脑内置键盘记录器？可窃取账号密码等敏感用户信息","dateModified":"2017-01-01T15:53:17+00:00","datePublished":"2017-01-01T15:53:17+00:00","mainEntityOfPage":{"@type":"WebPage","@id":"http://www.jfox.info/2017/7%E6%9C%886%E6%97%A5%E6%9B%B4%E6%96%B0%E6%83%A0%E6%99%AE%E7%94%B5%E8%84%91%E5%86%85%E7%BD%AE%E9%94%AE%E7%9B%98%E8%AE%B0%E5%BD%95%E5%99%A8%E5%8F%AF%E7%AA%83%E5%8F%96%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81.html"},"@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/main.css"><link type="application/atom+xml" rel="alternate" href="http://www.jfox.info/feed.xml" title="Java面试" /></head><body><header class="site-header" role="banner">
  <div class="wrapper"><a class="site-title" rel="author" href="/">Java面试</a><nav class="site-nav">
      <input type="checkbox" id="nav-trigger" class="nav-trigger" />
      <label for="nav-trigger">
        <span class="menu-icon">
          <svg viewBox="0 0 18 15" width="18px" height="15px">
            <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z" />
          </svg>
        </span>
      </label>

      <div class="trigger"><a class="page-link" href="/about/">About</a></div>
    </nav></div>
</header><main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">【7月6日更新】惠普电脑内置键盘记录器？可窃取账号密码等敏感用户信息</h1>
    <p class="post-meta">
      <time class="dt-published" datetime="2017-01-01T15:53:17+00:00" itemprop="datePublished">Jan 1, 2017
      </time></p>
  </header>

  <div class="post-content e-content" itemprop="articleBody">
    
<p>你在使用惠普电脑吗？如果答案是肯定的，那么请小心了，你的音频驱动程序可能会存储你的击键记录，甚至泄露你的重要信息。</p>

<h2 id="76更新">7.6更新</h2>

<p>6月，某部委下属网络安全和信息化领导小组办公室已经发布公告通报了惠普电脑存在隐藏键盘记录器问题。据说国内不少公务员也在用着惠普的PC设备，信息隐患实在细思恐极。</p>

<p><img src="a5b28b0.gif" alt="" /></p>

<p>而事实上，5月中旬，瑞士安全公司Modzero的安全研究员 Thorsten Schroeder 就已经发现，许多惠普笔记本电脑和平板电脑中的Conexant音频驱动程序变身Keylogger，记录用户的击键内容。Keylogger可以监测用户的每一次击键信息。该软件不仅仅捕获了特定按键的按键记录，而且还记录了每个按键的点击信息，并将它们存储在一个可读的文件中（ C:UsersPublicMicTray.log）。恶意软件或木马可以利用这一点，绕过系统对可疑行为的安全检测，获取记录文件，窃取用户的账户信息、信用卡卡号、聊天记录、密码等个人信息。</p>

<p><img src="a5b28b0.gif" alt="" /></p>

<p>Conexant是一家集成电路制造商，既生产音频芯片也开发相关驱动程序。Conexant High-Definition (HD) Audio Driver音频驱动程序可帮助软件与硬件进行通信。惠普公司根据不同的计算机型号，在Conexant音频驱动程序中写入一些控制特定按键（如媒体按键）的代码。研究人员发现，与Conexant音频驱动程序安装包一起安装的MicTray64.exe应用程序已在Windows系统中注册为计划任务，能够监控击键内容以确定用户是否按下了音频相关的按钮（例如静音/取消静音）。用户的击键记录保存在名为“Users/Public”的文件夹中，可以传送给OutputDebugString调试端口，这个端口允许通过MapViewOfFile函数访问该文件夹中的数据。</p>

<h2 id="音频驱动程序变成间谍软件">音频驱动程序变成间谍软件</h2>

<p>Schroeder在一篇博客中表示，该软件的目的是识别用户是否已经按下或松开特殊键。但是开发人员加入了诊断和调试功能，用于确保所有按键都可以通过调试界面广播出去，也可以写入硬盘上公共目录中的日志文件。这种调试将音频驱动程序转换成了内置的Keylogger。</p>

<p>研究显示，2015年12月发布的MicTray64.exe的早期版本并不会把击键记录存储到文件夹中。2016年10月，惠普将MicTray64.exe更新到1.0.0.46版本，增添了诊断功能，记录用户击键内容并存储到本地文件夹。目前，共有30种型号的惠普电脑装有1.0.0.46版本的MicTray64.exe。而根据文件的元信息，至少在2015年圣诞节时期，惠普电脑安装的该驱动程序就已经存在击键记录行为。</p>

<p>MicTray64.exe 1.0.0.46版本进行击键记录的具体过程如下：</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>int64 keylogger_enable(bool activate)

{

[...]

 if ( !keylogger_active )

 {

[...]

   // 13=WH_KEYBOARD_LL: Installs a hook procedure that

   // monitors low-level keyboard input events. For 

   // more information, see the LowLevelKeyboardProc 

   // hook procedure.

   hKeyloggerHook = SetWindowsHookExW(

 13, (HOOKPROC)handle_scancode, 

 hSelf, 

 0);

   if ( hKeyloggerHook )

   {

 keylogger_active = 1;

 return 0;

   }

[...]

}
</code></pre></div></div>

<p>记录功能激活之后，用户每按一次键盘，就会触发以下伪代码执行：</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>LRESULT handle_scancode(

int _in_nCode, 

WPARAM _in_wParam, 

tagKBDLLHOOKSTRUCT *_in_lParam_keystroke)

{

  tagKBDLLHOOKSTRUCT *key_stroke;

  WPARAM wParam;

  int nCode;

  int64 target; 

  DWORD is_keyfoo; 

  int is_keydown;

  char tmp; 

  int64 key_flags;

  int64 key_vk; 

  key_stroke   = _in_lParam_keystroke;

  wParam   = _in_wParam;

  nCode = _in_nCode;  

  if ( _in_nCode &gt;= 0 )

  {

 target = (cfg_HotKeyMicScancode &gt;&gt; 8 * 

   (cfg_HotKeyMicScancode_len - cfg_HotKeyMicScancode_len2));

 LODWORD(key_vk) = _in_lParam_keystroke-&gt;vkCode;

 LODWORD(key_flags)  = _in_lParam_keystroke-&gt;flags;

 is_keyfoo   = _in_lParam_keystroke-&gt;flags &amp; 1;

 is_keydown  = ~(key_flags &gt;&gt; 7) &amp; 1;

[*] send_to_dbglog(

   0x1D,

   L"Mic target 0x%x scancode 0x%x flags 0x%x extra 0x%x vk 0x%xn",

   target,

   _in_lParam_keystroke-&gt;scanCode,

   key_flags,

   _in_lParam_keystroke-&gt;dwExtraInfo,

   key_vk);  

 conexant_handle_fn_keys(

   cfg_MicMuteScancodeSettings,

   is_keydown,

   key_stroke-&gt;scanCode,

   target,

   &amp;cfg_HotKeyMicScancode_len,

   &amp;cfg_HotKeyMicScancode_len2,

   1);   

 if ( cfg_MicMuteScancodeSettings &amp; 4 )

   conexant_handle_fn_keys(

 cfg_MicMuteScancodeSettings,

 is_keydown,

 key_stroke-&gt;scanCode,

 (cfg_HotKeyMicScancode2 &gt;&gt; 8 * 

 (cfg_HotKeyMicScancode2_len - cfg_HotKeyMicScancode2_len2)),

 &amp;cfg_HotKeyMicScancode2_len,

 &amp;cfg_HotKeyMicScancode2_len2,

 1);  

 tmp = cfg_SpkMuteScancodeSettings; 

 if ( cfg_SpkMuteScancodeSettings &amp; 8 &amp;&amp; is_keyfoo 

  || !(cfg_SpkMuteScancodeSettings &amp; 8) )

 {

   conexant_handle_fn_keys(

 cfg_SpkMuteScancodeSettings,

 is_keydown,

 key_stroke-&gt;scanCode,

 (cfg_HotKeySpkScancode &gt;&gt; 8 * 

 (cfg_HotKeySpkScancode_len - cfg_HotKeySpkScancode_len2)),

 &amp;dword_1402709C8,

 &amp;dword_1402709CC,

 0);

   tmp = cfg_SpkMuteScancodeSettings;

 }  

 if ( tmp &amp; 4 &amp;&amp; (tmp &amp; 8 &amp;&amp; is_keyfoo || !(tmp &amp; 8)) )

   conexant_handle_fn_keys(

 tmp,

 is_keydown,

 key_stroke-&gt;scanCode,

 (cfg_HotKeySpkScancode2 &gt;&gt; 8 * 

 (cfg_HotKeySpkScancode2_len - cfg_HotKeySpkScancode2_len2)),

 &amp;cfg_HotKeySpkScancode2_len,

 &amp;cfg_HotKeySpkScancode2_len2,

 0);

  }

  return CallNextHookEx(hhk, nCode, wParam, key_stroke);

}
</code></pre></div></div>

<p>其中，[*]那部分代码触发的功能可以将击键记录写入文件，或通过运行store_keystroke()代码，将击键记录经由Microsofts Debug Monitor 接口广播出去：</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>void store_keystroke(LPCVOID lpBuffer)

{

  WORD *scancode_logline;

  int64 str_len;

  DWORD NumberOfBytesWritten;

  int str_newline; 

  scancode_logline = lpBuffer;

  if ( g_write_to_logfile )

  {

 SetFilePointer(g_hFile, 0, 0, 2);

 str_len = -1;

 while ( scancode_logline[str_len++ + 1] != 0 )

   ;   

 WriteFile(

   g_hFile, 

   scancode_logline, 

   2 * str_len, 

   &amp;NumberOfBytesWritten, 

   0); 

 str_newline = 'nr';

 WriteFile(g_hFile, &amp;str_newline, 4, &amp;NumberOfBytesWritten, 0);

  }

  else

  {

 OutputDebugStringW(lpBuffer);

  }

}
</code></pre></div></div>

<p>而目前没有证据表明惠普有意为Conexant音频驱动程序加入击键记录功能。 这很可能是开发人员疏忽导致的问题，使得该程序对用户造成潜在威胁。</p>

<p><img src="a5b28b0.gif" alt="" /></p>

<h2 id="存在风险的电脑型号及系统">存在风险的电脑型号及系统</h2>

<p>该漏洞被记录为“CVE-2017-8360”漏洞，已经影响了28款惠普笔记本电脑和平板电脑，包括EliteBook 800系列，EliteBook Folio G1，Elite X2, ProBook 600 和400系列, and ZBook等型号。Modzero的安全专家推断其他厂商出产的电脑如果装有Conexant硬件或驱动程序，也可能存在类似风险。</p>

<p>以下为存在问题的电脑型号：</p>

<p>HP EliteBook 820 G3 Notebook PC</p>

<p>HP EliteBook 828 G3 Notebook PC</p>

<p>HP EliteBook 840 G3 Notebook PC</p>

<p>HP EliteBook 848 G3 Notebook PC</p>

<p>HP EliteBook 850 G3 Notebook PC</p>

<p>HP ProBook 640 G2 Notebook PC</p>

<p>HP ProBook 650 G2 Notebook PC</p>

<p>HP ProBook 645 G2 Notebook PC</p>

<p>HP ProBook 655 G2 Notebook PC</p>

<p>HP ProBook 450 G3 Notebook PC</p>

<p>HP ProBook 430 G3 Notebook PC</p>

<p>HP ProBook 440 G3 Notebook PC</p>

<p>HP ProBook 446 G3 Notebook PC</p>

<p>HP ProBook 470 G3 Notebook PC</p>

<p>HP ProBook 455 G3 Notebook PC</p>

<p>HP EliteBook 725 G3 Notebook PC</p>

<p>HP EliteBook 745 G3 Notebook PC</p>

<p>HP EliteBook 755 G3 Notebook PC</p>

<p>HP EliteBook 1030 G1 Notebook PC</p>

<p>HP ZBook 15u G3 Mobile Workstation</p>

<p>HP Elite x2 1012 G1 Tablet</p>

<p>HP Elite x2 1012 G1 with Travel Keyboard</p>

<p>HP Elite x2 1012 G1 Advanced Keyboard</p>

<p>HP EliteBook Folio 1040 G3 Notebook PC</p>

<p>HP ZBook 17 G3 Mobile Workstation</p>

<p>HP ZBook 15 G3 Mobile Workstation</p>

<p>HP ZBook Studio G3 Mobile Workstation</p>

<p>HP EliteBook Folio G1 Notebook PC</p>

<p>可能会受影响的系统如下：</p>

<p>Microsoft Windows 10 32</p>

<p>Microsoft Windows 10 64</p>

<p>Microsoft Windows 10 IOT Enterprise 32-Bit (x86)</p>

<p>Microsoft Windows 10 IOT Enterprise 64-Bit (x86)</p>

<p>Microsoft Windows 7 Enterprise 32 Edition</p>

<p>Microsoft Windows 7 Enterprise 64 Edition</p>

<p>Microsoft Windows 7 Home Basic 32 Edition</p>

<p>Microsoft Windows 7 Home Basic 64 Edition</p>

<p>Microsoft Windows 7 Home Premium 32 Edition</p>

<p>Microsoft Windows 7 Home Premium 64 Edition</p>

<p>Microsoft Windows 7 Professional 32 Edition</p>

<p>Microsoft Windows 7 Professional 64 Edition</p>

<p>Microsoft Windows 7 Starter 32 Edition</p>

<p>Microsoft Windows 7 Ultimate 32 Edition</p>

<p>Microsoft Windows 7 Ultimate 64 Edition</p>

<p>Microsoft Windows Embedded Standard 7 32</p>

<p>Microsoft Windows Embedded Standard 7E 32-Bit</p>

<h2 id="应对方案">应对方案</h2>

<p>惠普已经积极做出响应，发布了修复方案。用户可以前往惠普客户支持页面，查询自己的电脑型号并下载新的音频驱动程序。此外，Windows系统更新时，也会针对这一问题进行修复。</p>

<p>为进一步确保安全，惠普电脑用户可以检查电脑硬盘，如果发现下列文件之一，就表明击键记录已经被获取：</p>

<p>C:WindowsSystem32MicTray64.exe</p>

<p>C:WindowsSystem32MicTray.exe</p>

<p>尽管每次登录之后文件会被覆盖，但如果程序再次启动，击键信息还是会被记录下去。如果用户将驱动程序备份到云储存或外部储存设备中，历史记录也会保存。</p>

<p>因此，一旦发现以上可执行的文件，用户最好立即将其删除或将文件重命名，以禁止MicTray驱动器继续读取击键记录。同时，删除“用户-公共文档”中的 MicTray.log日志文件夹。</p>

  </div><div style="width:300px;height:250px;float:left;">
    <!-- 300_250_1 -->
    <ins class="adsbygoogle" style="display:inline-block;width:300px;height:250px" data-ad-client="ca-pub-9477174171188196"
        data-ad-slot="4142158067"></ins>
    <script>
        (adsbygoogle = window.adsbygoogle || []).push({});
    </script>
</div>
<div style="width:300px;height:250px;float:left;">
    <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
    <!-- 300-250-2 -->
    <ins class="adsbygoogle" style="display:inline-block;width:300px;height:250px" data-ad-client="ca-pub-9477174171188196"
        data-ad-slot="5618891265"></ins>
    <script>
        (adsbygoogle = window.adsbygoogle || []).push({});
    </script>
</div><a class="u-url" href="/2017/7%E6%9C%886%E6%97%A5%E6%9B%B4%E6%96%B0%E6%83%A0%E6%99%AE%E7%94%B5%E8%84%91%E5%86%85%E7%BD%AE%E9%94%AE%E7%9B%98%E8%AE%B0%E5%BD%95%E5%99%A8%E5%8F%AF%E7%AA%83%E5%8F%96%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81.html" hidden></a>
</article>
<div class="PageNavigation">
  
  <a class="prev" href="/2017/%E6%95%B0%E6%8D%AE%E5%BA%94%E7%94%A8%E8%BE%BE%E4%BA%BA%E4%B9%8Bsql%E5%9F%BA%E7%A1%80%E6%95%99%E7%A8%8B%E5%88%86%E4%BA%AB11scalar%E5%87%BD%E6%95%B0.html">&laquo; 数据应用达人之SQL基础教程分享11-Scalar函数</a>
  
  
  <a class="next" href="/2017/%E7%A8%8B%E5%BA%8F%E5%91%98%E5%81%B7%E5%81%B7%E8%87%AA%E5%8A%A8%E5%8C%96%E6%AF%8F%E5%91%A8%E6%89%8D%E5%B7%A5%E4%BD%9C%E5%87%A0%E5%B0%8F%E6%97%B6%E5%8D%B4%E6%8B%BF%E5%85%A8%E8%96%AA%E8%BF%99%E6%A0%B7.html">程序员偷偷自动化，每周才工作几小时却拿全薪，这样道德么？ &raquo;</a>
  
</div>
<div class="sfix"><!-- 240x600 -->
<div class="fixedme">
    <ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-9477174171188196" data-ad-slot="9597600460"
        data-ad-format="auto"></ins>
    <script>
        (adsbygoogle = window.adsbygoogle || []).push({});
    </script>
</div>
<script type="text/javascript">
    function offset(target) {
        var top = 0,
            left = 0

        while (target.offsetParent) {
            top += target.offsetTop
            left += target.offsetLeft
            target = target.offsetParent
        }

        return {
            top: top,
            left: left,
        }
    }
    window.onload = function () {
        var e = document.getElementsByClassName('sfix')[0];
        e.offset = offset(e);

        window.onscroll = function (event) {
            var e = document.getElementsByClassName('sfix')[0];
            if (window.pageYOffset && e.offset && window.pageYOffset > e.offset.top) {
                e.style.position = 'fixed';
                e.style.left = e.offset.left + 'px';
                e.style.right = 'auto';


            } else {
                e.style.position = 'absolute';
                e.style.left = 'auto';
                e.style.right = '-240px';

            }
        }
    }

</script></div>

<style>
  .wrapper {
    position: relative;
  }

  .sfix {
    position: absolute;
    top: 0;
    right: -240px;
    width: 240px;
    height: 600px;
  }

  .PageNavigation {
    font-size: 14px;
    display: block;
    width: auto;
    overflow: hidden;
    clear: both;
  }

  .PageNavigation a {
    display: block;
    width: 50%;
    float: left;
    margin: 1em 0;
  }

  .PageNavigation .next {
    text-align: right;
    float: right;
  }
</style>
      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <h2 class="footer-heading">Java面试</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li class="p-name">Java面试</li></ul>
      </div>

      <div class="footer-col footer-col-2"><ul class="social-media-list"></ul>
</div>

      <div class="footer-col footer-col-3">
        <p></p>
      </div>
    </div>

  </div>

</footer>
</body>

</html>
