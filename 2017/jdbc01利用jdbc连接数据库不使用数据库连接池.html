<!-- build time:Sat Oct 27 2018 21:00:20 GMT+0800 (CST) --><!DOCTYPE html><html class="theme-next muse use-motion"><head><meta name="generator" content="Hexo 3.8.0"><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"><meta name="theme-color" content="#222"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css"><link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css"><link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css"><link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4"><link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4"><link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4"><link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222"><meta name="description" content="目录：1 什么是JDBC2 JDBC主要接口3 JDBC编程步骤【学渣版本】5 JDBC编程步骤【学神版本】6 JDBC编程步骤【学霸版本】1 什么是JDBCJDBC是JAVA提供的一套标准连接数据库的接口，规定了连接数据库的步骤和功能；不同的数据库提供商提供了一套JDBC实现类，他们称为数据库驱动。2 JDBC的主要接口Connection　　与数据库连接有关DriverManager 与创建数"><meta name="keywords" content="JAVA,面试"><meta property="og:type" content="article"><meta property="og:title" content="JDBC01 利用JDBC连接数据库【不使用数据库连接池】"><meta property="og:url" content="http://www.jfox.info/2017/jdbc01利用jdbc连接数据库不使用数据库连接池.html"><meta property="og:site_name" content="java面试"><meta property="og:description" content="目录：1 什么是JDBC2 JDBC主要接口3 JDBC编程步骤【学渣版本】5 JDBC编程步骤【学神版本】6 JDBC编程步骤【学霸版本】1 什么是JDBCJDBC是JAVA提供的一套标准连接数据库的接口，规定了连接数据库的步骤和功能；不同的数据库提供商提供了一套JDBC实现类，他们称为数据库驱动。2 JDBC的主要接口Connection　　与数据库连接有关DriverManager 与创建数"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="http://www.jfox.info/2017/1139/17b0a98.png"><meta property="og:image" content="http://www.jfox.info/2017/1139/32c4eda.png"><meta property="og:image" content="http://www.jfox.info/2017/1139/751e28f.gif"><meta property="og:image" content="http://www.jfox.info/wp-content/uploads/2017/07/1499355888.gif"><meta property="og:image" content="http://www.jfox.info/2017/1139/751e28f.gif"><meta property="og:image" content="http://www.jfox.info/wp-content/uploads/2017/07/1499355888.gif"><meta property="og:image" content="http://www.jfox.info/2017/1139/751e28f.gif"><meta property="og:image" content="http://www.jfox.info/wp-content/uploads/2017/07/1499355888.gif"><meta property="og:image" content="http://www.jfox.info/2017/1139/751e28f.gif"><meta property="og:image" content="http://www.jfox.info/wp-content/uploads/2017/07/1499355888.gif"><meta property="og:image" content="http://www.jfox.info/2017/1139/751e28f.gif"><meta property="og:image" content="http://www.jfox.info/wp-content/uploads/2017/07/1499355888.gif"><meta property="og:image" content="http://www.jfox.info/2017/1139/751e28f.gif"><meta property="og:image" content="http://www.jfox.info/wp-content/uploads/2017/07/1499355888.gif"><meta property="og:image" content="http://www.jfox.info/2017/1139/751e28f.gif"><meta property="og:image" content="http://www.jfox.info/wp-content/uploads/2017/07/1499355888.gif"><meta property="og:updated_time" content="2018-10-27T12:29:37.390Z"><meta name="twitter:card" content="summary"><meta name="twitter:title" content="JDBC01 利用JDBC连接数据库【不使用数据库连接池】"><meta name="twitter:description" content="目录：1 什么是JDBC2 JDBC主要接口3 JDBC编程步骤【学渣版本】5 JDBC编程步骤【学神版本】6 JDBC编程步骤【学霸版本】1 什么是JDBCJDBC是JAVA提供的一套标准连接数据库的接口，规定了连接数据库的步骤和功能；不同的数据库提供商提供了一套JDBC实现类，他们称为数据库驱动。2 JDBC的主要接口Connection　　与数据库连接有关DriverManager 与创建数"><meta name="twitter:image" content="http://www.jfox.info/2017/1139/17b0a98.png"><script type="text/javascript" id="hexo.configurations">var NexT=window.NexT||{},CONFIG={root:"/",scheme:"Muse",version:"5.1.4",sidebar:{position:"left",display:"post",offset:12,b2t:!1,scrollpercent:!1,onmobile:!1},fancybox:!0,tabs:!0,motion:{enable:!0,async:!1,transition:{post_block:"fadeIn",post_header:"slideDownIn",post_body:"slideDownIn",coll_header:"slideLeftIn",sidebar:"slideUpIn"}},duoshuo:{userId:"0",author:"Author"},algolia:{applicationID:"",apiKey:"",indexName:"",hits:{per_page:10},labels:{input_placeholder:"Search for Posts",hits_empty:"We didn't find any results for the search: ${query}",hits_stats:"${hits} results found in ${time} ms"}}}</script><link rel="canonical" href="http://www.jfox.info/2017/jdbc01利用jdbc连接数据库不使用数据库连接池.html"><title>JDBC01 利用JDBC连接数据库【不使用数据库连接池】 | java面试</title></head><body itemscope itemtype="http://schema.org/WebPage" lang="zh_CN"><div class="container sidebar-position-left page-post-detail"><div class="headband"></div><header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="header-inner"><div class="site-brand-wrapper"><div class="site-meta"><div class="custom-logo-site-title"><a href="/" class="brand" rel="start"><span class="logo-line-before"><i></i></span> <span class="site-title">java面试</span> <span class="logo-line-after"><i></i></span></a></div><p class="site-subtitle"></p></div><div class="site-nav-toggle"><button><span class="btn-bar"></span> <span class="btn-bar"></span> <span class="btn-bar"></span></button></div></div><nav class="site-nav"><ul id="menu" class="menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="menu-item-icon fa fa-fw fa-home"></i><br>Home</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="menu-item-icon fa fa-fw fa-archive"></i><br>Archives</a></li></ul></nav></div></header><main id="main" class="main"><div class="main-inner"><div class="content-wrap"><div id="content" class="content"><div id="posts" class="posts-expand"><article class="post post-type-normal" itemscope itemtype="http://schema.org/Article"><div class="post-block"><link itemprop="mainEntityOfPage" href="http://www.jfox.info/2017/jdbc01利用jdbc连接数据库不使用数据库连接池.html"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="name" content="Hello"><meta itemprop="description" content=""><meta itemprop="image" content="/images/avatar.gif"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="java面试"></span><header class="post-header"><h1 class="post-title" itemprop="name headline">JDBC01 利用JDBC连接数据库【不使用数据库连接池】</h1><div class="post-meta"><span class="post-time"><span class="post-meta-item-icon"><i class="fa fa-calendar-o"></i> </span><span class="post-meta-item-text">Posted on</span> <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-01-01T23:53:59+08:00">2017-01-01</time></span></div></header><div class="post-body" itemprop="articleBody"><p>目录：</p><p>1 什么是JDBC</p><p>2 JDBC主要接口</p><p>3 JDBC编程步骤【学渣版本】</p><p>5 JDBC编程步骤【学神版本】</p><p>6 JDBC编程步骤【学霸版本】</p><h2 id="1-什么是JDBC"><a href="#1-什么是JDBC" class="headerlink" title="1 什么是JDBC"></a>1 什么是JDBC</h2><p>JDBC是JAVA提供的一套标准连接数据库的接口，规定了连接数据库的步骤和功能；不同的数据库提供商提供了一套JDBC实现类，他们称为数据库驱动。</p><h2 id="2-JDBC的主要接口"><a href="#2-JDBC的主要接口" class="headerlink" title="2 JDBC的主要接口"></a>2 JDBC的主要接口</h2><p>Connection　　与数据库连接有关</p><p>DriverManager 与创建数据库连接对象有关</p><p>Statement 与执行SQL语句有关</p><p>ResultSet 与返回的结果及有关</p><p>注意：通过JDBC操作数据库是自动提交的，当然也可是设置成手动提交</p><h2 id="3-利用JDBC操作数据库的步骤【学渣版本】"><a href="#3-利用JDBC操作数据库的步骤【学渣版本】" class="headerlink" title="3 利用JDBC操作数据库的步骤【学渣版本】"></a>3 利用JDBC操作数据库的步骤【学渣版本】</h2><h3 id="3-1-导入数据库驱动"><a href="#3-1-导入数据库驱动" class="headerlink" title="　　3.1 导入数据库驱动"></a>　　3.1 导入数据库驱动</h3><p>Class.forName(“数据库驱动包”);</p><p>注意：Class.forName的底层实际上是利用的java反射机制</p><pre><code>　　　　例如：Class.forName(&quot;com.mysql.jdbc.Driver&quot;); //mysql驱动包的固定写法
</code></pre><h3 id="3-2-创建连接"><a href="#3-2-创建连接" class="headerlink" title="　　3.2 创建连接"></a>　　3.2 创建连接</h3><p>Connection conn = DriverManager.getConnection(“jdbc:mysql:// + IP + : + 端口 + / + 数据库名称”，“数据库用户名”，“密码”);</p><p>注意：DriverManager是一个驱动管理类，通过调用该类的静态方法DriverManager来创建连接对象</p><pre><code>　　　　例如：　　Connection conn = DriverManager.getConnection(
 　　　　　　　　　　&quot;jdbc:mysql://localhost:3306/test&quot;, // jdbc:mysql:// + IP + : + 端口 + / + 数据库名称  
           　　　　&quot;root&quot;, // 用户名
　　　　　　 　　　　&quot;182838&quot;); // 用户密码
</code></pre><h3 id="3-3-创建语句对象"><a href="#3-3-创建语句对象" class="headerlink" title="　　3.3 创建语句对象"></a>　　3.3 创建语句对象</h3><p>Statement state = conn.createStatement();</p><p>注意：利用连接对象来创建语句对象</p><h3 id="3-4-执行SQL语句"><a href="#3-4-执行SQL语句" class="headerlink" title="　　3.4 执行SQL语句"></a>　　3.4 执行SQL语句</h3><p>ResultSet executeQuery(String sql)</p><p>用来执行查询语句(DQL)的方法,返回的是一个查询结果集</p><p>Integer executUpdate(String sql)</p><p>用来执行DML语句的方法,返回值为执行了该DML后影响了数据库中多少条数据</p><p>boolean execute(String sql)</p><p>可以执行所有类型的SQL语句,但是DQL,DML都有专门的方法,所以该方法通常<br>用来执行DDL语句.当返回值为true时表示该SQL语句执行后有结果集,没有结果集<br>的都是返回的false.(并不是根据语句的对错来返回true或者false)</p><p>注意：利用语句对象来执行SQL语句，DQL指查询，DML指修改、删除、插入，DDL指新建</p><p>注意：如果是查询语句会得到一个结果集，结果集类型是ResultSet，可对结果集进行遍历</p><p><img src="/2017/1139/17b0a98.png" alt=""></p><h3 id="3-5-遍历结果集"><a href="#3-5-遍历结果集" class="headerlink" title="　　3.5 遍历结果集"></a>　　3.5 遍历结果集</h3><p><img src="/2017/1139/32c4eda.png" alt=""></p><h3 id="3-6-关闭语句对象、关闭连接对象"><a href="#3-6-关闭语句对象、关闭连接对象" class="headerlink" title="　　3.6 关闭语句对象、关闭连接对象"></a>　　3.6 关闭语句对象、关闭连接对象</h3><p>执行对象.close();</p><p>连接对象.close();<br><img src="/2017/1139/751e28f.gif" alt=""><img src="/wp-content/uploads/2017/07/1499355888.gif" alt=""><br>1<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemalocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd">2<modelversion>4.0.0</modelversion>3<groupid>cn.xiangxu</groupid>4<artifactid>testJDBC</artifactid>5<version>0.0.1-SNAPSHOT</version>6<dependencies>7<dependency>8<groupid>mysql</groupid>9<artifactid>mysql-connector-java</artifactid>10<version>5.1.37</version>11</dependency>12<dependency>13<groupid>junit</groupid>14<artifactid>junit</artifactid>15<version>4.12</version>16</dependency>17</dependencies>18</project></p><p>maven依赖包<img src="/2017/1139/751e28f.gif" alt=""><img src="/wp-content/uploads/2017/07/1499355888.gif" alt=""><br>1CREATE TABLE user (<br>2 id INT (10) PRIMARY KEY,<br>3 name VARCHAR (10),<br>4 pwd VARCHAR (10)<br>5);<br>6 7DESC USER;<br>8 9DROP TABLE user;<br>1011 SELECT * FROM user;</p><p>SQL语句<img src="/2017/1139/751e28f.gif" alt=""><img src="/wp-content/uploads/2017/07/1499355888.gif" alt=""><br>1package testJDBC;<br>2 3import java.sql.Connection;<br>4import java.sql.DriverManager;<br>5import java.sql.ResultSet;<br>6import java.sql.SQLException;<br>7import java.sql.Statement;<br>8 9import org.junit.Test;<br>1011publicclass TestCase {<br>12 @Test<br>13publicvoid test01() {<br>14 Connection conn = null;<br>15try {<br>16// 01 导入驱动模块17 Class.forName(“com.mysql.jdbc.Driver”);<br>1819// 02 初始化连接对象（以为在之前就创建了，进行初始化就行啦）20 conn = DriverManager.getConnection(<br>21 “jdbc:mysql://localhost:3306/test”, “root”, “182838”);<br>2223// 03 创建执行对象24 Statement state = conn.createStatement();<br>2526 String sql = “SELECT * FROM user “;<br>2728// 04 执行SQL语句29 ResultSet rs = state.executeQuery(sql); // 查询结果的类型为ResultSet<br>3031// 05 遍历查询结果32while(rs.next()) { // 遍历结果集33 System.out.println(rs.getString(“name”));<br>34 }<br>3536// 06 关闭执行对象、连接对象37 state.close();<br>38 conn.close();<br>3940 } catch (ClassNotFoundException e) {<br>41// TODO Auto-generated catch block42 e.printStackTrace();<br>43 } catch (SQLException e) {<br>44// TODO Auto-generated catch block45 e.printStackTrace();<br>46 } finally {<br>47if(null != conn) { // 判断连接是否关闭48try {<br>49 conn.close();<br>50 } catch (SQLException e) {<br>51// TODO Auto-generated catch block52 e.printStackTrace();<br>53 }<br>54 }<br>55 }<br>5657 }<br>58 }</p><p>java代码</p><h2 id="4-存在的问题"><a href="#4-存在的问题" class="headerlink" title="4 存在的问题"></a>4 存在的问题</h2><h2 id="4-1-重复编译问题"><a href="#4-1-重复编译问题" class="headerlink" title="　　4.1 重复编译问题"></a>　　4.1 重复编译问题</h2><p>利用 Statement对象执行SQL语句时每执行一条SQL语句在数据库端就会进行一次变异，如果是类似的SQL语句也是这样；严重加大了数据库的负担</p><p>改进：利用预编译的Statement</p><p>注意：预编译statement向数据库中发送一个sql语句，数据库编译sql语句，并把编译的结果保存在数据库砖的缓存中。下次再发sql时，如果sql相同，则不会再编译，直接使用缓存中的。</p><h3 id="4-2-释放资源问题"><a href="#4-2-释放资源问题" class="headerlink" title="　　4.2 释放资源问题　　"></a>　　4.2 释放资源问题</h3><p>程序执行后应该对 结果集、执行对象、连接对象进行释放，而且在finally那里还需要判断是否成功释放（注意：try里面定义的变量在finally是获取不到的）</p><p>改进：在程序的最前面定义 连接对象、执行对象、结果集对象；在程序结束后调用各自的close方法来释放资源，在finally中判断这三个对象是否成功关闭</p><h2 id="5-jdbc编程步骤【学神版本】"><a href="#5-jdbc编程步骤【学神版本】" class="headerlink" title="5 jdbc编程步骤【学神版本】"></a>5 jdbc编程步骤【学神版本】</h2><p>加载数据库驱动</p><p>创建并获取数据库链接</p><p>创建jdbc statement对象</p><p>设置sql语句</p><p>设置sql语句中的参数(使用preparedStatement)</p><p>通过statement执行sql并获取结果</p><p>对sql执行结果进行解析处理</p><p>释放资源(resultSet、preparedstatement、connection)<br><img src="/2017/1139/751e28f.gif" alt=""><img src="/wp-content/uploads/2017/07/1499355888.gif" alt=""><br>1package testJDBC;<br>2 3import java.sql.Connection;<br>4import java.sql.DriverManager;<br>5import java.sql.PreparedStatement;<br>6import java.sql.ResultSet;<br>7import java.sql.SQLException;<br>8 9import org.junit.Test;<br>1011publicclass TestCase {<br>12 @Test<br>13publicvoid test01() {<br>14 Connection conn = null;<br>15 PreparedStatement ps = null;<br>16 ResultSet rs = null;<br>17try {<br>18 Class.forName(“com.mysql.jdbc.Driver”); // 加载数据库驱动1920 conn = DriverManager.getConnection( // 初始化连接对象21 “jdbc:mysql://localhost:3306/test”, “root”, “182838”);<br>222324 String sql = “SELECT * FROM user WHERE pwd = ? “; // 拼接SQL语句，位置参数用？代替2526 ps = conn.prepareStatement(sql); // 初始化预编译执行对象2728 ps.setString(1, “182838”); // 设置SQL语句中的位置位置参数（注意：是从1开始数不是从0开始数）2930 rs = ps.executeQuery(); // 执行SQL语句3132while(rs.next()) { // 遍历结果集33 System.out.println(“====================”);<br>34 System.out.println(rs.getInt(“id”));<br>35 System.out.println(rs.getString(“name”));<br>36 System.out.println(rs.getString(“pwd”));<br>37 }<br>3839// 释放资源40 rs.close();<br>41 ps.close();<br>42 conn.close();<br>4344 } catch (Exception e) {<br>45// TODO Auto-generated catch block46 e.printStackTrace();<br>47 } finally {<br>48if(rs != null) {<br>49try {<br>50 rs.close();<br>51 } catch (SQLException e) {<br>52// TODO Auto-generated catch block53 e.printStackTrace();<br>54 }<br>55 }<br>56if(ps != null) {<br>57try {<br>58 ps.close();<br>59 } catch (SQLException e) {<br>60// TODO Auto-generated catch block61 e.printStackTrace();<br>62 }<br>63 }<br>64if(conn != null) {<br>65try {<br>66 conn.close();<br>67 } catch (SQLException e) {<br>68// TODO Auto-generated catch block69 e.printStackTrace();<br>70 }<br>71 }<br>72 }<br>7374 }<br>75 }</p><p>优化后的java代码</p><h2 id="6-可优化的地方【学霸版本】"><a href="#6-可优化的地方【学霸版本】" class="headerlink" title="6 可优化的地方【学霸版本】"></a>6 可优化的地方【学霸版本】</h2><p>没有将查询到的结果封装换成一个对象<br><img src="/2017/1139/751e28f.gif" alt=""><img src="/wp-content/uploads/2017/07/1499355888.gif" alt=""><br>1package cn.xiangxu.entity;<br>2 3import java.io.Serializable;<br>4 5publicclass User implements Serializable {<br>6 7privatestaticfinallong serialVersionUID = -5109978284633713580L;<br>8 9private Integer id;<br>10private String name;<br>11private String pwd;<br>12public User() {<br>13super();<br>14// TODO Auto-generated constructor stub15 }<br>16public User(Integer id, String name, String pwd) {<br>17super();<br>18this.id = id;<br>19this.name = name;<br>20this.pwd = pwd;<br>21 }<br>22 @Override<br>23publicint hashCode() {<br>24finalint prime = 31;<br>25int result = 1;<br>26 result = prime * result + ((id == null) ? 0 : id.hashCode());<br>27return result;<br>28 }<br>29 @Override<br>30publicboolean equals(Object obj) {<br>31if (this == obj)<br>32returntrue;<br>33if (obj == null)<br>34returnfalse;<br>35if (getClass() != obj.getClass())<br>36returnfalse;<br>37 User other = (User) obj;<br>38if (id == null) {<br>39if (other.id != null)<br>40returnfalse;<br>41 } elseif (!id.equals(other.id))<br>42returnfalse;<br>43returntrue;<br>44 }<br>45public Integer getId() {<br>46return id;<br>47 }<br>48publicvoid setId(Integer id) {<br>49this.id = id;<br>50 }<br>51public String getName() {<br>52return name;<br>53 }<br>54publicvoid setName(String name) {<br>55this.name = name;<br>56 }<br>57public String getPwd() {<br>58return pwd;<br>59 }<br>60publicvoid setPwd(String pwd) {<br>61this.pwd = pwd;<br>62 }<br>63 @Override<br>64public String toString() {<br>65return “User [id=” + id + “, name=” + name + “, pwd=” + pwd + “]”;<br>66 }<br>67686970 }</p><p>user表对应的实体类<img src="/2017/1139/751e28f.gif" alt=""><img src="/wp-content/uploads/2017/07/1499355888.gif" alt=""><br>1package testJDBC;<br>2 3import java.sql.Connection;<br>4import java.sql.DriverManager;<br>5import java.sql.PreparedStatement;<br>6import java.sql.ResultSet;<br>7import java.sql.SQLException;<br>8import java.util.ArrayList;<br>9import java.util.List;<br>1011import org.junit.Test;<br>1213import cn.xiangxu.entity.User;<br>1415publicclass TestCase {<br>16 @Test<br>17publicvoid test01() {<br>18 Connection conn = null;<br>19 PreparedStatement ps = null;<br>20 ResultSet rs = null;<br>21try {<br>22 Class.forName(“com.mysql.jdbc.Driver”); // 加载数据库驱动2324 conn = DriverManager.getConnection( // 初始化连接对象25 “jdbc:mysql://localhost:3306/test”, “root”, “182838”);<br>262728 String sql = “SELECT * FROM user WHERE pwd = ? “; // 拼接SQL语句，位置参数用？代替2930 ps = conn.prepareStatement(sql); // 初始化预编译执行对象3132 ps.setString(1, “182838”); // 设置SQL语句中的位置位置参数（注意：是从1开始数不是从0开始数）3334 rs = ps.executeQuery(); // 执行SQL语句3536 List<user>users = new ArrayList<user>(); // 创建一个集合来存放记录对象37while(rs.next()) { // 遍历结果集<br>38// System.out.println(“====================”);<br>39// System.out.println(rs.getInt(“id”));<br>40// System.out.println(rs.getString(“name”));<br>41// System.out.println(rs.getString(“pwd”));42 User user = new User();<br>43 user.setId(rs.getInt(“id”));<br>44 user.setName(rs.getString(“name”));<br>45 user.setPwd(rs.getString(“pwd”));<br>46 users.add(user); // 向集合中添加元素47 }<br>4849 System.out.println(users); // 打印输出集合50for(User user : users) {<br>51 System.out.println(user);<br>52 }<br>5354// 释放资源55 rs.close();<br>56 ps.close();<br>57 conn.close();<br>5859 } catch (Exception e) {<br>60// TODO Auto-generated catch block61 e.printStackTrace();<br>62 } finally {<br>63if(rs != null) {<br>64try {<br>65 rs.close();<br>66 } catch (SQLException e) {<br>67// TODO Auto-generated catch block68 e.printStackTrace();<br>69 }<br>70 }<br>71if(ps != null) {<br>72try {<br>73 ps.close();<br>74 } catch (SQLException e) {<br>75// TODO Auto-generated catch block76 e.printStackTrace();<br>77 }<br>78 }<br>79if(conn != null) {<br>80try {<br>81 conn.close();<br>82 } catch (SQLException e) {<br>83// TODO Auto-generated catch block84 e.printStackTrace();<br>85 }<br>86 }<br>87 }<br>8889 }<br>90 }</user></user></p><p>对查询结果进行封装了的java代码</p><h2 id="7-小案例"><a href="#7-小案例" class="headerlink" title="7 小案例"></a>7 小案例</h2><p>用户登录、转账系统<br><img src="/2017/1139/751e28f.gif" alt=""><img src="/wp-content/uploads/2017/07/1499355888.gif" alt=""><br>1package day01;<br>2 3import java.sql.Connection;<br>4import java.sql.DriverManager;<br>5import java.sql.ResultSet;<br>6import java.sql.SQLException;<br>7import java.sql.Statement;<br>8import java.util.ArrayList;<br>9import java.util.List;<br>10import java.util.Scanner;<br>11 12/<strong> 13 <em>用户登录系统<br>14 </em>Description:<br>15*/ 16publicclass Service {<br>17privatestaticfinalint USER_REG = 1;<br>18privatestaticfinalint USER_LOGIN = USER_REG + 1;<br>19privatestaticfinalint USER_UPDATE = USER_LOGIN + 1;<br>20privatestaticfinalint USER_DELETE = USER_UPDATE + 1;<br>21privatestaticfinalint USER_INFO = USER_DELETE + 1;<br>22privatestaticfinalint USER_TRANSFER = USER_INFO + 1;<br>23privatestaticfinalint USER_QUIT = USER_TRANSFER + 1;<br>24privatestaticfinalint EXIT = USER_QUIT + 1;<br>25 26 UserInfo user = null;<br>27 28publicstaticvoid main(String[] args) {<br>29 Service serv = new Service();<br>30 serv.start();<br>31 }<br>32 33privatevoid start() {<br>34 welcome();<br>35int code = getCode();<br>36 execute(code);<br>37 }<br>38 39/</strong> 40 <em>执行选择<br>41 </em>Description:<br>42<em>/ 43privatevoid execute(int code) {<br>44switch (code) {<br>45case USER_REG:<br>46 user_reg();<br>47break;<br>48case USER_LOGIN:<br>49 user_login();<br>50break;<br>51case USER_UPDATE:<br>52 user_update();<br>53break;<br>54case USER_DELETE:<br>55 user_delete();<br>56break;<br>57case USER_INFO:<br>58 user_info();<br>59break;<br>60case USER_TRANSFER:<br>61 user_transfer();<br>62break;<br>63case USER_QUIT:<br>64 user_quit();<br>65break;<br>66case EXIT:<br>67 exit();<br>68break;<br>69default:<br>70 System.out.println(“输入错误，请重新输入”);<br>71 start();<br>72break;<br>73 }<br>74 }<br>75 76/** 77 </em>Description:<br>78<em>/ 79privatevoid exit() {<br>80// TODO Auto-generated method stub 81if(null != this.user) {<br>82 System.out.println(“当前用户还没有退出，所以执行自动退出当前用户”);<br>83 user_quit();<br>84 }else {<br>85 System.out.println(“你选择了退出系统”);<br>86 System.out.println(“系统退出成功”);<br>87 }<br>88 89 }<br>90 91/** 92 </em>退出当前用户<br>93 <em>Description:<br>94</em>/ 95privatevoid user_quit() {<br>96// TODO Auto-generated method stub 97if(null != this.user) {<br>98 System.out.println(“你选择了退出当前用户功能”);<br>99this.user = null;<br>100if(null == this.user) {<br>101 System.out.println(“成功退出当前用户”);<br>102 }else {<br>103 System.out.println(“退出当前用户失败”);<br>104 }<br>105 }else {<br>106 System.out.println(“你还没有登录成功，还不能使用该功能”);<br>107 System.out.println(“请登录！”);<br>108 user_login();<br>109 }<br>110 start();<br>111 }<br>112113/<strong>114 <em>转账功能<br>115 </em>Description:<br>116*/117privatevoid user_transfer() {<br>118// TODO Auto-generated method stub119if(null != this.user) {<br>120 System.out.println(“你选择了转账功能！”);<br>121 Scanner scanner = new Scanner(System.in);<br>122 System.out.println(“请输入转入账户的用户名：”);<br>123 String name = scanner.nextLine();<br>124 System.out.println(“请输入转账金额：”);<br>125int money = Integer.parseInt(scanner.nextLine());<br>126127 Connection conn = null;<br>128try {<br>129 Class.forName(“com.mysql.jdbc.Driver”);<br>130 conn = DriverManager.getConnection(<br>131 “jdbc:mysql://localhost:3306/test”,<br>132 “root”,<br>133 “182838”);<br>134 Statement state = conn.createStatement();<br>135136//转出137 String out_sql = “UPDATE userinfo_fury “<br>138 + “SET account = account - ‘“+money+”‘ “<br>139 + “WHERE username = ‘“+this.user.getUsername()+”‘ “;<br>140int judge01 = state.executeUpdate(out_sql);<br>141if(judge01 &gt; 0) {<br>142 System.out.println(“转出成功”);<br>143 }else {<br>144 System.out.println(“转出失败”);<br>145 }<br>146147//转入148 String in_sql = “UPDATE userinfo_fury “<br>149 + “SET account = account + ‘“+money+”‘ “<br>150 + “WHERE username = ‘“+name+”‘ “;<br>151int judge02 = state.executeUpdate(in_sql);<br>152if(judge02 &gt; 0) {<br>153 System.out.println(“转入成功”);<br>154 }else {<br>155 System.out.println(“转入失败”);<br>156 }<br>157 }catch(Exception e) {<br>158 e.printStackTrace();<br>159 }finally {<br>160if(null != conn) {<br>161try {<br>162 conn.close();<br>163 }catch(SQLException e1) {<br>164 e1.printStackTrace();<br>165 }<br>166 }<br>167 }<br>168 }else {<br>169 System.out.println(“请先登录！”);<br>170 user_login();<br>171 }<br>172 start();<br>173 }<br>174175/</strong>176 <em>查询表中的所有数据<br>177 </em>Description:<br>178<em>/179privatevoid user_info() {<br>180// TODO Auto-generated method stub181if(null != this.user) {<br>182 System.out.println(“你选择了查询所有用户功能！”);<br>183 Connection conn = null;<br>184try {<br>185 Class.forName(“com.mysql.jdbc.Driver”);<br>186 conn = DriverManager.getConnection(<br>187 “jdbc:mysql://localhost:3306/test”,<br>188 “root”,<br>189 “182838”);<br>190 Statement state = conn.createStatement();<br>191 String sql = “SELECT id,username,password,email,nickname,account “<br>192 + “FROM userinfo_fury “;<br>193 ResultSet rs = state.executeQuery(sql);<br>194 List<userinfo>list = new ArrayList<userinfo>();<br>195196while(rs.next()) {<br>197int id = rs.getInt(“id”);<br>198 String username = rs.getString(“username”);<br>199 String password = rs.getString(“password”);<br>200 String email = rs.getString(“email”);<br>201 String nickname = rs.getString(“nickname”);<br>202double account = rs.getDouble(“account”);<br>203 UserInfo userinfo = new UserInfo(id, username, password, email, nickname, account);<br>204 list.add(userinfo);<br>205 }<br>206for(UserInfo lis : list) {<br>207 System.out.println(lis);<br>208 }<br>209 }catch(Exception e) {<br>210 e.printStackTrace();<br>211 }finally {<br>212if(null != conn) {<br>213try {<br>214 conn.close();<br>215 }catch(SQLException e1) {<br>216 e1.printStackTrace();<br>217 }<br>218 }<br>219 }<br>220 }else {<br>221 System.out.println(“请先登录”);<br>222 user_login();<br>223 }<br>224 start();<br>225 }<br>226227/**228</userinfo></userinfo></em>删除用户<br>229 <em>Description:<br>230</em>/231privatevoid user_delete() {<br>232// TODO Auto-generated method stub233if(null != this.user) {<br>234 System.out.println(“你选择了删除用户功能”);<br>235 System.out.println(“你不是超级用户，你无法使用删除用户功能”);<br>236 }else {<br>237 System.out.println(“请先登录！”);<br>238 user_login();<br>239 }<br>240 start();<br>241 }<br>242243/<strong>244 <em>修改用户信息<br>245 </em>Description:<br>246*/247privatevoid user_update() {<br>248// TODO Auto-generated method stub249if(null != this.user) {<br>250 System.out.println(“你选择了修改当前用户功能!”);<br>251//可改进 –&gt;&gt; 可由用户选择需要修改的字段252 System.out.println(“你当前的昵称为：” + this.user.getNickname());<br>253 Scanner scanner = new Scanner(System.in);<br>254 System.out.println(“你想将你的昵称修改为：”);<br>255 String nickname = scanner.nextLine();<br>256257 Connection conn = null;<br>258try {<br>259 Class.forName(“com.mysql.jdbc.Driver”);<br>260 conn = DriverManager.getConnection(<br>261 “jdbc:mysql://localhost:3306/test”,<br>262 “root”,<br>263 “182838”);<br>264 Statement state = conn.createStatement();<br>265266 String sql = “UPDATE userinfo_fury “<br>267 + “SET nickname = ‘“+nickname+”‘ “<br>268 + “WHERE username = ‘“+this.user.getUsername()+”‘ “;<br>269int judge = state.executeUpdate(sql);<br>270if(judge &gt; 0) {<br>271this.user.setNickname(nickname);<br>272 System.out.println(“修改昵称成功,当前昵称为：” + this.user.getNickname());<br>273 }else {<br>274 System.out.println(“修改昵称失败”);<br>275 }<br>276 }catch(Exception e) {<br>277 e.printStackTrace();<br>278 }finally {<br>279if(null != conn) {<br>280try {<br>281 conn.close();<br>282 }catch(SQLException e1) {<br>283 e1.printStackTrace();<br>284 }<br>285 }<br>286 }<br>287 }else {<br>288 System.out.println(“请登录成功后在进行此操作！”);<br>289 user_login();<br>290 }<br>291 start();<br>292 }<br>293294/</strong>295 <em>用户登录<br>296 </em>Description:<br>297<em>/298privatevoid user_login() {<br>299// TODO Auto-generated method stub300 System.out.println(“你选择了用户登录功能！”);<br>301 Scanner scanner = new Scanner(System.in);<br>302 System.out.println(“请输入用户名:”);<br>303 String username = scanner.nextLine();<br>304 System.out.println(“请输入密码：”);<br>305 String password = scanner.nextLine();<br>306307 Connection conn = null;<br>308try {<br>309 Class.forName(“com.mysql.jdbc.Driver”);<br>310 conn = DriverManager.getConnection(<br>311 “jdbc:mysql://localhost:3306/test”,<br>312 “root”,<br>313 “182838”);<br>314 Statement state = conn.createStatement();<br>315316 String sql = “SELECT id, username, password,email, nickname,account “<br>317 + “FROM userinfo_fury “<br>318 + “WHERE username = ‘“+username+”‘ “<br>319 + “AND password = ‘“+password+”‘ “;<br>320 System.out.println(sql);<br>321 ResultSet rs = state.executeQuery(sql);<br>322if(rs.next()) {<br>323int id = rs.getInt(“id”);<br>324 String name = rs.getString(“username”);<br>325 String word = rs.getString(“password”);<br>326 String email = rs.getString(“email”);<br>327 String nickname = rs.getString(“nickname”);<br>328double account = rs.getDouble(“account”);<br>329 UserInfo userinfo = new UserInfo(id, name, word, email, nickname, account);<br>330this.user = userinfo;<br>331 System.out.println(“登录成功,你的昵称为：” + this.user.getNickname());<br>332 }else {<br>333 System.out.println(“登录失败:” + this.user);<br>334 }<br>335/</em>336 <em>注意：<br>337 </em>当用户输入的密码个的格式是： 任意字符’ or ‘数值开头 时无论用户名和密码正确与否，都会登录成功<br>338 <em>因为 如果这样输入就改变了 SQL 语句的原意（在SQL语句中AND的优先级要高于OR）<br>339 </em>实例 ： asdfaer1234’ or ‘1<br>340<em>/341 }catch(Exception e) {<br>342 e.printStackTrace();<br>343 }finally {<br>344if(null != conn) {<br>345try {<br>346 conn.close();<br>347 }catch(SQLException e1) {<br>348 e1.printStackTrace();<br>349 }<br>350 }<br>351 }<br>352 start();<br>353 }<br>354355/**356 </em>用户注册<br>357 <em>Description:<br>358</em>/359privatevoid user_reg() {<br>360 System.out.println(“你选择了用户注册功能！”);<br>361 Scanner scanner = new Scanner(System.in);<br>362 System.out.println(“请输入用户名：”);<br>363 String username = scanner.nextLine();<br>364 System.out.println(“请输入密码：”);<br>365 String password = scanner.nextLine();<br>366 System.out.println(“请输入邮箱：”);<br>367 String email = scanner.nextLine();<br>368 System.out.println(“请输入昵称：”);<br>369 String nickname = scanner.nextLine();<br>370 Connection conn = null;<br>371try {<br>372 Class.forName(“com.mysql.jdbc.Driver”);<br>373 conn = DriverManager.getConnection(<br>374 “jdbc:mysql://localhost:3306/test”,<br>375 “root”,<br>376 “182838”);<br>377 Statement state = conn.createStatement();<br>378 String sql = “INSERT INTO userinfo_fury “<br>379 + “(username,password,email,nickname) “<br>380 + “VALUES “<br>381 + “(‘“+username+”‘,’”+password+”‘,’”+email+”‘,’”+nickname+”‘)”;<br>382int judge = state.executeUpdate(sql);<br>383if(judge &gt; 0) {<br>384 System.out.println(“注册成功”);<br>385 }else {<br>386 System.out.println(“注册失败”);<br>387 }<br>388 }catch(Exception e) {<br>389 e.printStackTrace();<br>390 }finally {<br>391if(null != conn) {<br>392try {<br>393 conn.close();<br>394 }catch(SQLException e1) {<br>395 e1.printStackTrace();<br>396 }<br>397 }<br>398 }<br>399 start();<br>400 }<br>401402/<strong>403 <em>功能选择<br>404 </em>Description:<br>405*/406privateint getCode() {<br>407 System.out.println(“请选择功能：”);<br>408 Scanner scanner = new Scanner(System.in);<br>409int code = Integer.parseInt(scanner.nextLine());<br>410return code;<br>411 }<br>412413/</strong>414 <em>界面信息<br>415 </em>Description:<br>416*/417privatevoid welcome() {<br>418 System.out.println(“欢迎使用用户登录系统！”);<br>419 System.out.println(“请输入需要操作的功能序号”);<br>420 System.out.println(“======================”);<br>421 System.out.println(“================”);<br>422 System.out.println(“1 : 用户注册”);<br>423 System.out.println(“2 : 用户登录”);<br>424 System.out.println(“3 : 修改用户信息”);<br>425 System.out.println(“4 : 删除用户”);<br>426 System.out.println(“5 : 查看所有用户信息”);<br>427 System.out.println(“6 : 转账业务”);<br>428 System.out.println(“7 : 用户退出”);<br>429 System.out.println(“8 : 退出系统”);<br>430 System.out.println(“================”);<br>431 System.out.println(“======================”);<br>432 }<br>433 }</p></div><div style="width:300px;height:250px;float:left"><ins class="adsbygoogle" style="display:inline-block;width:300px;height:250px" data-ad-client="ca-pub-9477174171188196" data-ad-slot="4142158067"></ins><script>(adsbygoogle=window.adsbygoogle||[]).push({})</script></div><div style="width:300px;height:250px;float:left"><ins class="adsbygoogle" style="display:inline-block;width:300px;height:250px" data-ad-client="ca-pub-9477174171188196" data-ad-slot="5618891265"></ins><script>(adsbygoogle=window.adsbygoogle||[]).push({})</script></div><footer class="post-footer"><div class="post-nav"><div class="post-nav-next post-nav-item"><a href="/2017/solr66搜索环境搭建ik中文分词同义词拼音solrj的使用.html" rel="next" title="solr6.6搜索环境搭建、IK中文分词、同义词、拼音、solrj的使用"><i class="fa fa-chevron-left"></i> solr6.6搜索环境搭建、IK中文分词、同义词、拼音、solrj的使用</a></div><span class="post-nav-divider"></span><div class="post-nav-prev post-nav-item"><a href="/2017/协同过滤推荐算法详解.html" rel="prev" title="协同过滤推荐算法详解 » java面试题">协同过滤推荐算法详解 » java面试题 <i class="fa fa-chevron-right"></i></a></div></div></footer></div></article><div class="post-spread"></div></div></div></div><div class="sidebar-toggle"><div class="sidebar-toggle-line-wrap"><span class="sidebar-toggle-line sidebar-toggle-line-first"></span> <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span> <span class="sidebar-toggle-line sidebar-toggle-line-last"></span></div></div><aside id="sidebar" class="sidebar"><div class="sidebar-inner"><ul class="sidebar-nav motion-element"><li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">Table of Contents</li><li class="sidebar-nav-overview" data-target="site-overview-wrap">Overview</li></ul><section class="site-overview-wrap sidebar-panel"><div class="site-overview"><div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person"><p class="site-author-name" itemprop="name">Hello</p><p class="site-description motion-element" itemprop="description"></p></div><nav class="site-state motion-element"><div class="site-state-item site-state-posts"><a href="/archives/"><span class="site-state-item-count">1358</span> <span class="site-state-item-name">posts</span></a></div></nav></div></section><section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active"><div class="post-toc"><div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#1-什么是JDBC"><span class="nav-number">1.</span> <span class="nav-text">1 什么是JDBC</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-JDBC的主要接口"><span class="nav-number">2.</span> <span class="nav-text">2 JDBC的主要接口</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-利用JDBC操作数据库的步骤【学渣版本】"><span class="nav-number">3.</span> <span class="nav-text">3 利用JDBC操作数据库的步骤【学渣版本】</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#3-1-导入数据库驱动"><span class="nav-number">3.1.</span> <span class="nav-text">3.1 导入数据库驱动</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-2-创建连接"><span class="nav-number">3.2.</span> <span class="nav-text">3.2 创建连接</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-3-创建语句对象"><span class="nav-number">3.3.</span> <span class="nav-text">3.3 创建语句对象</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-4-执行SQL语句"><span class="nav-number">3.4.</span> <span class="nav-text">3.4 执行SQL语句</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-5-遍历结果集"><span class="nav-number">3.5.</span> <span class="nav-text">3.5 遍历结果集</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-6-关闭语句对象、关闭连接对象"><span class="nav-number">3.6.</span> <span class="nav-text">3.6 关闭语句对象、关闭连接对象</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-存在的问题"><span class="nav-number">4.</span> <span class="nav-text">4 存在的问题</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-1-重复编译问题"><span class="nav-number">5.</span> <span class="nav-text">4.1 重复编译问题</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#4-2-释放资源问题"><span class="nav-number">5.1.</span> <span class="nav-text">4.2 释放资源问题</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#5-jdbc编程步骤【学神版本】"><span class="nav-number">6.</span> <span class="nav-text">5 jdbc编程步骤【学神版本】</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#6-可优化的地方【学霸版本】"><span class="nav-number">7.</span> <span class="nav-text">6 可优化的地方【学霸版本】</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#7-小案例"><span class="nav-number">8.</span> <span class="nav-text">7 小案例</span></a></li></ol></div></div></section></div></aside><div class="sfix"><div class="fixedme"><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-9477174171188196" data-ad-slot="9597600460" data-ad-format="auto"></ins><script>(adsbygoogle=window.adsbygoogle||[]).push({})</script></div><script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script></div></div></main><footer id="footer" class="footer"><div class="footer-inner"><div class="copyright">&copy; <span itemprop="copyrightYear">2018</span> <span class="with-love"><i class="fa fa-user"></i> </span><span class="author" itemprop="copyrightHolder">Hello</span></div><div class="powered-by">Powered by <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a></div><span class="post-meta-divider">|</span><div class="theme-info">Theme &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Muse</a> v5.1.4</div></div></footer><div class="back-to-top"><i class="fa fa-arrow-up"></i></div></div><script type="text/javascript">"[object Function]"!==Object.prototype.toString.call(window.Promise)&&(window.Promise=null)</script><script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script><script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script><script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script><script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script><script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script><script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script><script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script><script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script><script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.4"></script><script type="text/javascript" src="/js/src/post-details.js?v=5.1.4"></script><script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script></body></html><!-- rebuild by neat -->